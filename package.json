{
  "name": "eltor-app-monorepo",
  "version": "1.0.0",
  "private": true,
  "description": "Monorepo for eltor-app",
  "scripts": {
    "tauri": "npm run env && cd frontend && pnpm run dev:tauri",
    "web": "concurrently \"npm run env && pnpm run backend\" \"pnpm run frontend\"",
    "frontend": "cd frontend && pnpm run dev:web",
    "backend": "cd backend && ./run.sh",
    "build:web": "cd frontend && pnpm run build",

    "prod": "npm run build:prod && npm run start:prod",
    "build:prod": "npm run build:frontend && npm run build:backend",
    "build:frontend": "cd frontend && pnpm install --no-frozen-lockfile && pnpm run build",
    "build:backend": "cd backend && cargo build --release",
    "start:prod": "BIND_ADDRESS=${BIND_ADDRESS:-127.0.0.1} BACKEND_PORT=${BACKEND_PORT:-${PORT:-5174}} BACKEND_URL=${BACKEND_URL:-} ./backend/target/release/eltor-backend",
    
    "env": "source scripts/exports.sh",
    "docker": "npm run build:frontend && DOCKER_BUILDKIT=1 docker-compose up --build",
    "docker:build:arm": "TARGETARCH=aarch64 DOCKER_BUILDKIT=1 BUILDKIT_PROGRESS=plain npm run build:frontend && docker buildx build --platform linux/arm64 --build-arg TARGETARCH=aarch64 -t eltor/eltor:latest-arm64 .",
    "docker:build:amd": "TARGETARCH=x86_64 DOCKER_BUILDKIT=1 BUILDKIT_PROGRESS=plain npm run build:frontend && docker buildx build --platform linux/amd64 --build-arg TARGETARCH=amd64 -t eltor/eltor:latest-amd64 .",
    "docker:tag": "docker tag eltor/eltor:latest eltor/eltor:v0.0.15",
    "docker:push": "docker push eltor/eltor:latest",
    "docker:clean": "DOCKER_BUILDKIT=1 docker-compose up --build --no-cache",

    "actions:list": "act --list",
    "actions": "act push --secret-file .secrets --matrix platform:linux/arm64 -j build-docker-arm -P macos-latest=catthehacker/ubuntu:act-latest"
  },
  "workspaces": [
    "frontend",
    "backend"
  ],
  "devDependencies": {
    "concurrently": "^8.2.2"
  }
}
